<script>
  // Helper: get ?post=slug
  function getParam(name){const u=new URL(location.href);return u.searchParams.get(name)}
  // Helper: remove leading YAML front-matter --- ... ---
  function stripFrontMatter(md){
    // Matches a leading block starting with --- and ending with the next ---
    return md.replace(/^---[\s\S]*?---\s*/,'');
  }

  const slug = getParam('post');
  const target = document.getElementById('content');

  if(!slug){
    target.innerHTML = '<p>Article not specified.</p>';
  } else {
    fetch('articles/' + slug + '.md')
      .then(r => r.ok ? r.text() : Promise.reject('Not found'))
      .then(md => {
        const bodyOnly = stripFrontMatter(md);
        target.innerHTML = marked.parse(bodyOnly);
        window.scrollTo(0,0);
      })
      .catch(() => {
        target.innerHTML = '<p>Article not found.</p>';
      });
  }
</script>
